var $jscomp={scope:{},findInternal:function(a,d,b){a instanceof String&&(a=String(a));for(var g=a.length,k=0;k<g;k++){var h=a[k];if(d.call(b,h,k,a))return{i:k,v:h}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,d,b){if(b.get||b.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[d]=b.value)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,d,b,g){if(d){b=$jscomp.global;a=a.split(".");for(g=0;g<a.length-1;g++){var k=a[g];k in b||(b[k]={});b=b[k]}a=a[a.length-1];g=b[a];d=d(g);d!=g&&null!=d&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:d})}};
$jscomp.polyfill("Array.prototype.findIndex",function(a){return a?a:function(a,b){return $jscomp.findInternal(this,a,b).i}},"es6-impl","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var d=0;return $jscomp.iteratorPrototype(function(){return d<a.length?{done:!1,value:a[d++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.array=$jscomp.array||{};$jscomp.iteratorFromArray=function(a,d){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var b=0,g={next:function(){if(b<a.length){var k=b++;return{value:d(k,a[k]),done:!1}}g.next=function(){return{done:!0,value:void 0}};return g.next()}};g[Symbol.iterator]=function(){return g};return g};
$jscomp.polyfill("Array.prototype.entries",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a,b){return[a,b]})}},"es6-impl","es3");$jscomp.checkStringArgs=function(a,d,b){if(null==a)throw new TypeError("The 'this' value for String.prototype."+b+" must not be null or undefined");if(d instanceof RegExp)throw new TypeError("First argument to String.prototype."+b+" must not be a regular expression");return a+""};
$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,b){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,b||0)}},"es6-impl","es3");var host=window.location.hostname,devState;"localhost"===host?devState="dev":devState="prod";
var c=document.getElementById("canvas"),ctx=c.getContext("2d"),tooltip=document.getElementById("tooltip"),offsetWidth=200,offsetHeight=75,cWidth=c.width-offsetWidth,margin=110,pxSize=10,txPerLine=Math.ceil(cWidth/pxSize),textColor="#000000",strokeColorNorm="#cccccc",strokeColorSelect="#ff0000",fontFace="Consolas",fontSizeHeader="13px",fontSizeAxis="11px",txAmountToPoll=15E3,maxTransactions=15E3,websocketActive=!1,coordinator="KPWCHICGJZXKE9GSUDXZYUAPLHAKAHYHDXN",pxColorUnconf={r:0,g:0,b:0,a:1},pxColorConf=
{r:0,g:255,b:0,a:1},pxColorReattach={r:255,g:255,b:0,a:1},pxColorMilestone={r:0,g:0,b:255,a:1},pxColorAvgConfTime={r:244,g:65,b:205,a:1},txList=[],filterForValueTX=!1,filterForSpecificAddresses=[],filterAddress="",manualPoll=!1,endlessMode=!1,selectedAddress="",selectedAddressBuffer="",totalConfRate=0,totalConfRateEff=0,totalConfirmations=[],milestoneMetrics=[],milestoneIntervalList=[],milestoneInterval=0,totalConfirmationTime=0,totalTransactions=0,totalTPS=0,totalCTPS=0,totalTPSeff=0,totalCTPSeff=
0,effectiveConfRateIndex=0,topList=[],toplistAdditional=0,topListCount=0,toplistSortIndex=[2,"desc"],toplistMinTX=10,InitialHistoryPollCount=10,mousePos,pixelMap=[],timer=[],rateLimiter=0,txOfMousePosition={},ChangeAddress=function(){selectedAddress=document.getElementById("address_input").value.substring(0,81);selectedAddressBuffer=document.getElementById("address_input").value.substring(0,81)};document.getElementById("address_button").onclick=function(){ChangeAddress()};
var getRowPosition=function(a){a=a.getBoundingClientRect();return{left:a.left+window.scrollX,top:a.top+window.scrollY}};
function createTable(a){a=_.filter(a,function(a){return a[2]>=toplistMinTX});a=_.orderBy(a,function(a){return a[toplistSortIndex[0]][0]},[toplistSortIndex[1]]);var d=document.getElementById("toplist");d.innerHTML="";var b=document.createElement("thead"),g=document.createElement("tbody"),k=document.createElement("tr");topListCount=0;15<=a.length?topListCount=15:topListCount=a.length;topListCount+=toplistAdditional;topListCount>=a.length?topListCount=a.length:0>topListCount&&(topListCount=0);var h=
document.getElementById("hideSpecificAddressCheckboxWrapper");h.classList.add("hide");if(0<a.length){for(var e={},f=0;f<topListCount;e={current_row:e.current_row},f++){e.current_row=document.createElement("tr");e.current_row.addEventListener("mouseenter",function(a){return function(){filterAddress=a.current_row.getAttribute("tx");var b=getRowPosition(a.current_row);h.style.top=b.top+1+"px";h.style.left=b.left-20+"px";h.classList.remove("hide")}}(e),!1);for(var l={},m=0;m<a[0].length;l={current_cell:l.current_cell},
m++){l.current_cell=document.createElement("td");l.current_cell.addEventListener("click",function(a){return function(){selectedAddress=a.current_cell.getAttribute("tx");selectedAddressBuffer=a.current_cell.getAttribute("tx");document.getElementById("address_input").value=a.current_cell.getAttribute("tx")}}(l),!1);var n=void 0;switch(m){case 0:n=""+(f+1);break;case 1:n=(a[f][1].substring(0,35)===coordinator?"[COO]"+coordinator.substring(0,30):a[f][1].substring(0,35))+"...";break;case 2:n=a[f][2]+" ["+
Math.round(parseInt(a[f][2])/maxTransactions*100)+"%]";break;case 3:n=a[f][3][0]+" ["+(100>a[f][3][1]?a[f][3][1].toFixed(1):a[f][3][1].toFixed(0))+"%]";break;case 4:n=a[f][4][0]+" ["+(100>a[f][4][1]?a[f][4][1].toFixed(1):a[f][4][1].toFixed(0))+"%]";break;case 5:n=""+(Infinity===a[f][5][0]?"inf.":a[f][5][0].toFixed(2));break;case 6:n=""+(Infinity===a[f][6][0]?"inf.":0<a[f][6][0]?"+":"")+(Infinity>a[f][6][0]?a[f][6][0].toFixed(0)+"%":"");break;case 7:n=""+a[f][7][0].toFixed(2);break;case 8:n=""+a[f][8][0].toFixed(2);
break;case 9:n=a[f][9][0].toFixed(1)+" min";break;case 10:n=""+(0<a[f][10][0]?"+":"")+a[f][10][0].toFixed(1)+"%";break;default:n="N/A"}n=document.createTextNode(n);l.current_cell.appendChild(n);l.current_cell.setAttribute("tx",a[f][1]);e.current_row.setAttribute("tx",a[f][1]);0<=a[f][6][0]&&6==m?l.current_cell.setAttribute("style","color: #008000"):0>a[f][6][0]&&6==m?l.current_cell.setAttribute("style","color: #ff0000"):0<=a[f][10][0]&&10==m?l.current_cell.setAttribute("style","color: #ff0000"):0>
a[f][10][0]&&10==m&&l.current_cell.setAttribute("style","color: #008000");e.current_row.appendChild(l.current_cell)}g.appendChild(e.current_row)}for(e={i$0:0};e.i$0<a[0].length;e={i$0:e.i$0},e.i$0++){f=document.createElement("td");l=document.createElement("img");l.setAttribute("src","img/sort.png");l.classList.add("table_head_sortpic");m=void 0;switch(e.i$0){case 0:m="#";break;case 1:m="Address";break;case 2:m="Total";break;case 3:m="Confirmed";break;case 4:m="Unconfirmed";break;case 5:m="C.Ratio";
break;case 6:m="\u00b1Avg.C.Ratio";break;case 7:m="TPS";break;case 8:m="CTPS";break;case 9:m="~C.Time";break;case 10:m="\u00b1Avg.Time";break;default:m="N/A"}m=document.createTextNode(m);f.appendChild(m);0<e.i$0&&f.appendChild(l);k.appendChild(f);f.addEventListener("click",function(a){return function(){toplistSortIndex=a.i$0===toplistSortIndex[0]&&"desc"===toplistSortIndex[1]?[a.i$0,"asc"]:[a.i$0,"desc"];createTable(topList)}}(e),!1)}b.appendChild(k);d.appendChild(b);d.appendChild(g)}}
var GetMousePos=function(a,d){if(null==d.pageX&&null!=d.clientX){var b=document.documentElement,g=document.body;d.pageX=d.clientX+(b&&b.scrollLeft||g&&g.scrollLeft||0)-(b.clientLeft||0);d.pageY=d.clientY+(b&&b.scrollTop||g&&g.scrollTop||0)-(b.clientTop||0)}b=a.getBoundingClientRect();return{x:d.clientX-b.left,y:d.clientY-b.top,xReal:d.pageX,yReal:d.pageY}},GetTXofMousePosition=function(a){a.y-=offsetHeight;a.x-=margin;return pixelMap.reduce(function(d,b){a.x>=b.x&&a.x<b.x+pxSize&&a.y>=b.y&&a.y<b.y+
pxSize&&(d=b);return d},0)},OpenLink=function(a){a&&window.open("https://thetangle.org/address/"+a);txOfMousePosition.hash&&window.open("https://thetangle.org/transaction/"+txOfMousePosition.hash)};
c.addEventListener("mousemove",function(a){25<Date.now()-rateLimiter&&(mousePos=GetMousePos(c,a),txOfMousePosition=GetTXofMousePosition(mousePos),txOfMousePosition.hash?(a=_.round((txOfMousePosition.ctime-txOfMousePosition.receivedAt)/1E3/60,2),a=txOfMousePosition.confirmed?a+" Minutes":txOfMousePosition.reattached?"Reattached transaction":"Not confirmed yet",tooltip.innerHTML="Address:\u00a0"+txOfMousePosition.address+"<br>\n                                TX Hash:\u00a0"+txOfMousePosition.hash+
"<br>\n                                Bundle:\u00a0\u00a0"+txOfMousePosition.bundle+"<br>\n                                Tag:\u00a0\u00a0\u00a0\u00a0\u00a0"+txOfMousePosition.tag+"<br>\n                                C. Time:\u00a0"+a+"<br>\n                                Value:\u00a0\u00a0\u00a0"+(0!==txOfMousePosition.value?Math.round(txOfMousePosition.value/1E6*100)/100+" MIOTA":"Zero value transaction"),selectedAddress=txOfMousePosition.address,tooltip.style.display="block",tooltip.style.top=
mousePos.yReal+15+"px",tooltip.style.left=mousePos.xReal+15+"px",document.body.style.cursor="pointer"):(tooltip.style.display="none",document.body.style.cursor="auto",txOfMousePosition={},selectedAddress=""),rateLimiter=Date.now())},!1);c.addEventListener("mouseout",function(){tooltip.style.display="none";document.body.style.cursor="auto";txOfMousePosition={};selectedAddress=selectedAddressBuffer},!1);
var netselector=document.getElementById("netselector"),netSwitch=function(){window.location.replace("https://"+("mainnet"===netselector.value?"www":netselector.value)+".tanglemonitor.com")};netselector.addEventListener("change",netSwitch);document.getElementById("address_button_reset").addEventListener("click",function(){selectedAddressBuffer=selectedAddress="";document.getElementById("address_input").value=""},!1);var checkBoxZero=document.getElementById("hideZero");
document.getElementById("hideZero").addEventListener("click",function(){!0===checkBoxZero.checked?(filterForValueTX=!0,txList=FilterZeroValue(txList)):(filterForValueTX=!1,InitialHistoryPoll(!1));CalcToplist(!1)},!1);document.getElementById("hideSpecificAddressCheckboxWrapper").addEventListener("click",function(){filterForSpecificAddresses.push(filterAddress);txList=FilterSpecificAddresses(txList);CalcToplist(!1)},!1);var maxTransactionsBuffer=maxTransactions,checkBoxEndless=document.getElementById("endlessMode");
document.getElementById("endlessMode").addEventListener("click",function(){!0===checkBoxEndless.checked?(endlessMode=!0,maxTransactionsBuffer=maxTransactions,maxTransactions=1E13):(endlessMode=!1,maxTransactions=maxTransactionsBuffer)},!1);checkBoxZero.checked=!1;checkBoxEndless.checked=!1;c.addEventListener("click",function(){OpenLink(!1)},!1);document.getElementById("toplist-more").addEventListener("click",function(){toplistAdditional+=5;createTable(topList)},!1);
document.getElementById("toplist-all").addEventListener("click",function(){toplistAdditional=1E4;createTable(topList)},!1);document.getElementById("toplist-reset").addEventListener("click",function(){toplistAdditional=0;createTable(topList)},!1);document.getElementById("minNumberOfTxIncluded_button").addEventListener("click",function(){toplistMinTX=parseInt(document.getElementById("minNumberOfTxIncluded").value);createTable(topList)},!1);
document.getElementById("txToPollWrapper_button").addEventListener("click",function(){txAmountToPoll=parseInt(document.getElementById("txToPoll").value);document.getElementById("loadingTX").classList.remove("hide");manualPoll=!0;maxTransactions=txAmountToPoll;InitialHistoryPoll(!1)},!1);
var calcLineCount=function(a,d,b){return Math.floor(a*d/b)},UpdateTXStatus=function(a,d){var b=a.hash,g=a.milestone,k=a.ctime,h=txList.findIndex(function(a){return a.hash===b});if(-1!==h&&void 0!==txList[h]){if("txConfirmed"===d||"Milestone"===d)txList[h].ctime=k,txList[h].confirmed=!0;"Milestone"===d&&(txList[h].milestone=g);"Reattach"===d&&(txList[h].reattached=!0)}else console.log(("Milestone"===d?"Milestone":"TX")+" not found in local DB - Hash: "+b+" | updateType: "+d)},DrawCanvas=function(a){for(ctx.clearRect(0,
0,cWidth+offsetWidth,c.height);c.height<timer.length*pxSize*2+offsetHeight+30;)c.height+=50;var d=[];a.map(function(a,g){var b=calcLineCount(g,pxSize,cWidth);d.push({x:g*pxSize-b*pxSize*txPerLine,y:b*pxSize,hash:a.hash,bundle:a.bundle,address:a.address,value:a.value,tag:a.tag,confirmed:a.confirmed,reattached:a.reattached,receivedAt:a.receivedAt,receivedAtms:a.receivedAtms,timestamp:a.timestamp,ctime:a.ctime,milestone:a.milestone})});pixelMap=d;ctx.font=fontSizeHeader+" "+fontFace;ctx.fillStyle=textColor;
ctx.textBaseline="hanging";ctx.textAlign="left";ctx.fillText("Total TX count       "+totalTransactions,margin+10,10);ctx.fillText("Avg. TPS             "+totalTPS,margin+10,25);ctx.fillText("Avg. conf.rate       "+totalConfRate+" %",margin+10,40);ctx.fillText("Avg. eff. conf.rate  "+totalConfRateEff+" %",margin+10,55);ctx.fillText("Avg. conf. time   "+totalConfirmationTime+" min",margin+240,10);ctx.fillText("Avg. CTPS         "+totalCTPS,margin+240,25);ctx.fillText("Avg. MS interval  "+milestoneInterval+
" min",margin+240,40);ctx.fillText("Unconfirmed",cWidth-60,10);ctx.fillText("Confirmed",cWidth-60,25);ctx.fillText("Reattached",cWidth+40,10);ctx.fillText("Milestone",cWidth+40,25);ctx.fillText("Avg.conf.time indicator",cWidth-60,40);ctx.fillStyle="rgba(0,0,0,1)";ctx.fillRect(cWidth-75,10,pxSize,pxSize);ctx.fillStyle="rgba(0,255,0,1)";ctx.fillRect(cWidth-75,25,pxSize,pxSize);ctx.fillStyle="rgba(255,255,0,1)";ctx.fillRect(cWidth+25,10,pxSize,pxSize);ctx.fillStyle="rgba(0,0,255,1)";ctx.fillRect(cWidth+
25,25,pxSize,pxSize);ctx.fillStyle="rgba(244,65,205,1)";ctx.fillRect(cWidth-75,40,pxSize,pxSize);d.map(function(a,d){var b=0,h=2*txPerLine;if(0==d%h){var e=d/h;ctx.font=fontSizeAxis+" "+fontFace;ctx.fillStyle=textColor;ctx.textBaseline="hanging";ctx.textAlign="right";var f=txList.slice(e*h,e*h+h),h=f.length,f=f.filter(function(a){return!1!==a.confirmed}).length,h=Math.round(f/(f+(h-f))*100),e=Math.round(2*txPerLine/(timer[e+1]/1E3-timer[e]/1E3)*10)/10;ctx.fillText((isNaN(h)?"0":h)+"%"+(isNaN(e)?" [...]":
" ["+e.toFixed(1)+" TPS]"),margin-5,a.y+offsetHeight+5)}e=pxColorUnconf;h=strokeColorNorm;if(!1===a.confirmed||void 0===a.confirmed)e=pxColorUnconf,h=strokeColorNorm,e.a=1;"f"===a.milestone&&!0===a.reattached&&(e=pxColorReattach,h=strokeColorNorm,e.a=1);!0===a.confirmed&&"f"===a.milestone&&(e=pxColorConf,h=strokeColorNorm,e.a=1);"m"===a.milestone&&(ctx.fillStyle="rgba(255, 255, 255, 1)",ctx.fillRect(margin+cWidth+5,a.y+offsetHeight,100,pxSize),ctx.font=fontSizeAxis+" "+fontFace,ctx.fillStyle=textColor,
ctx.textBaseline="hanging",ctx.textAlign="left",e=pxColorMilestone,h=strokeColorNorm,f=Math.floor((parseInt(Date.now())-a.receivedAt)/1E3/60),ctx.fillText(f+" min",margin+cWidth+5,a.y+offsetHeight),e.a=1);"t"===a.milestone&&(e=pxColorMilestone,h=strokeColorNorm,e.a=1);a.address===selectedAddress&&(h=strokeColorSelect,b=1,e.a=1);d===effectiveConfRateIndex&&(h=strokeColorNorm,e=pxColorAvgConfTime,b=1);ctx.fillStyle="rgba("+e.r+","+e.g+","+e.b+","+e.a+")";ctx.fillRect(a.x+margin,a.y+offsetHeight,pxSize,
pxSize);ctx.strokeStyle=h;ctx.lineWidth=1;ctx.strokeRect(a.x+margin,a.y+offsetHeight,pxSize-b,pxSize-b)});window.setTimeout(function(){return DrawCanvas(txList)},100)},CalcToplist=function(a){var d=_.groupBy(txList,"confirmed");if(d&&d["true"]&&d["true"].length){var b=_.countBy(d["true"],"address"),g=_.countBy(d["false"],"address"),k=d["true"].length,h=d["false"].length,e=_.assignInWith(b,g,function(a,b){a=_.defaultTo(a,0);return[a,b]}),e=Object.entries(e),e=e.reduce(function(a,b){Array.isArray(b[1])?
a.push(b):a.push([b[0],[b[1],0]]);return a},[]);e.map(function(a,b){var f=a[1][1],g=a[1][0],l=d["true"].reduce(function(b,d){d.address===a[0]?b[0].push(d.ctime-d.receivedAt):b[1].push(d.ctime-d.receivedAt);return b},[[],[]]),q=l[0],l=_.mean(l[1])/1E3/60,q=_.mean(q)/1E3/60,l=q/l*100-100,p=f+g,t=g/p*100,u=f/p*100,r=g/p,v=r/(k/h)*100-100,w=Math.round(p/((Date.now()-txList[0].receivedAt)/1E3)*100)/100,x=Math.round(g/((Date.now()-txList[0].receivedAt)/1E3)*100)/100;e[b].unshift([0]);e[b].pop();e[b].push([p]);
e[b].push([g,t]);e[b].push([f,u]);e[b].push([r]);e[b].push([v]);e[b].push([w]);e[b].push([x]);e[b].push([q]);e[b].push([l])});topList=e;0<e.length&&createTable(e)}a&&window.setTimeout(function(){return CalcToplist(!0)},15E3)},CalcMetrics=function(){orderTxList();var a=Date.now();milestoneMetrics=[];milestoneIntervalList=[];totalTransactions=txList.length;totalTransactions>=maxTransactions&&txList.splice(0,txPerLine*Math.floor(totalTransactions/maxTransactions));var d=[];txList.map(function(a,b){0===
b%(2*txPerLine)&&d.push(a.receivedAt)});timer=d;var b=_.meanBy(totalConfirmations,function(a){if(!1===a.milestone)return a.ctime});totalConfirmationTime=_.round(b/1E3/60,1);totalConfirmations=txList.reduce(function(d,e){!0===e.confirmed&&(d.push({ctime:e.ctime-e.receivedAt,milestone:"f"===e.milestone?!1:!0,effective:e.receivedAt>a-b?!1:!0}),"m"===e.milestone&&milestoneMetrics.push(e.receivedAt));return d},[]);var g=_.countBy(totalConfirmations,"effective")["true"];milestoneMetrics.map(function(a,
b){0<b&&milestoneIntervalList.push(a-milestoneMetrics[b-1])});milestoneInterval=Math.round(_.mean(milestoneIntervalList)/1E3/60*10)/10;var k=totalConfirmations.length;totalConfRate=Math.round(k/(k+(totalTransactions-k))*1E4)/100;effectiveConfRateIndex=_.findIndex(txList,function(d){return d.receivedAt>a-b});0<totalTransactions&&(totalTPS=Math.round(totalTransactions/((a-txList[0].receivedAt)/1E3)*100)/100,totalCTPS=Math.round(k/((a-txList[0].receivedAt)/1E3)*100)/100,txList[effectiveConfRateIndex]&&
txList[effectiveConfRateIndex].receivedAt&&(totalTPSeff=Math.round(effectiveConfRateIndex/((a-txList[effectiveConfRateIndex].receivedAt)/1E3)*100)/100,totalCTPSeff=Math.round(g/((a-txList[effectiveConfRateIndex].receivedAt)/1E3)*100)/100,totalConfRateEff=Math.round(totalCTPSeff/totalTPSeff*1E4)/100));15<totalTPS&&!endlessMode&&!manualPoll?maxTransactions=3E4:15>=totalTPS&&!endlessMode&&!manualPoll&&(maxTransactions=15E3);window.setTimeout(function(){return CalcMetrics()},1500)},InitialHistoryPoll=
function(a){var d="";"prod"===devState?d="https://tanglemonitor.com:4433/api/v1/getRecentTransactions?amount="+txAmountToPoll:d="http://localhost:8080/api/v1/getRecentTransactions?amount="+txAmountToPoll;fetch(d,{cache:"no-cache"}).then(function(a){return a.json()}).then(function(b){document.getElementById("loading").style.display="none";document.getElementById("loadingTX").classList.add("hide");filterForValueTX&&(b.txHistory=FilterZeroValue(b.txHistory));0<filterForSpecificAddresses.length&&(b.txHistory=
FilterSpecificAddresses(b.txHistory));txList=_.reverse(b.txHistory);CalcMetrics();a&&CalcToplist(!0);a&&!websocketActive&&InitWebSocket()})["catch"](function(b){console.error("Error fetching txHistory",b);0<InitialHistoryPollCount&&(window.setTimeout(function(){return InitialHistoryPoll(a)},2500),InitialHistoryPollCount--)})},orderTxList=function(){txList=_.orderBy(txList,["receivedAt"],["asc"])},InitWebSocket=function(){var a="";"prod"===devState?a="https://tanglemonitor.com:4434":a="http://localhost:8081";
var d=!0;"prod"===devState?d=!0:d=!1;var b=io.connect(a,{secure:d,reconnect:!0});b.on("connect",function(){console.log("Successfully connected to Websocket..");websocketActive=!0;b.on("newTX",function(a){var b=[!0];filterForValueTX&&0!==a.value?b.push(!0):filterForValueTX?b.push(!1):b.push(!0);0<filterForSpecificAddresses.length&&(filterForSpecificAddresses.includes(a.address)?b.push(!1):b.push(!0));b.includes(!1)||txList.push(a)});b.on("update",function(a){UpdateTXStatus(a,"txConfirmed")});b.on("updateMilestone",
function(a){UpdateTXStatus(a,"Milestone")});b.on("updateReattach",function(a){UpdateTXStatus(a,"Reattach")})})},FilterZeroValue=function(a){return _.filter(a,function(a){return 0!==a.value||"m"===a.milestone})},FilterSpecificAddresses=function(a){return _.filter(a,function(a){return!filterForSpecificAddresses.includes(a.address)})},Main=function(){DrawCanvas(txList);InitialHistoryPoll(!0)};Main();
